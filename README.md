Primary navigation
Homepage
 12
 11
 Search or go to…
Project
C
Contributing Rules

Pinned
Issues
0
Merge requests
1

Manage

Plan

Code
Merge requests
1
Repository
Branches
Commits
Tags
Repository graph
Compare revisions
Snippets
Locked files

Build

Secure

Deploy

Operate

Monitor

Analyze
KS Model Group
matlab
Contributing Rules
Merge requests
!2
docs: первая версия требований и рекомендаций по документированию MATLAB-кода (KSMDL-4310)
Open
docs: первая версия требований и рекомендаций по документированию MATLAB-кода (KSMDL-4310)
KSMDL-4310-documenting-rules-v1
into
main
Overview 
25
Commits 
7
Pipelines 
7
Changes 
1
3 unresolved threads
Open
Alexander Nezhin
requested to merge
KSMDL-4310-documenting-rules-v1
into
main
1 month ago
Overview 25
Commits 
7
Pipelines 
7
Changes 1
3 unresolved threads
Compare
and
 1 file
+
1095
−
0
 docstyle.md  0 → 100644
+
1095
−
0

Viewed
# Требования и рекомендации по оформлению MATLAB-кода

## Введение

Техническая документация включает все необходимые материалы, чтобы разработчики и пользователи могли легко понять и использовать предоставленный код. Она включает описание функций, модулей и классов, что помогает ориентироваться в проекте, поддерживать и развивать его.

При разработке подхода к документированию были поставлены следующие цели:

1. Удобочитаемость документации из редактора MATLAB.
2. Удобочитаемость документации при выводе её при помощи `help`.
3. Простота программного анализа документации в m-файлах.

В представленном подходе к документированию кода в MATLAB используется 8 документирующих блоков для функций и классов и 7 для скриптов.

При этом здесь и далее:

1. Под функциями понимаются как файл-функции, так и методы, вложенные функции и подфункции, если не указано иное.
2. Под переменными понимаются входные и выходные параметры функций, а также свойства классов.
3. Примеры в разделе "[[#Требования и рекомендации]]" несут цель продемонстрировать конкретно представленные требование или блок требований. В связи с чем примеры могут быть упрощены и противоречить другим требованиям и рекомендациям.
4. Так как одна из целей - простота программного анализа, то формат каждого блока строго определён. Все пункты, перечисленные в каком-либо разделе являются обязательными для исполнения, если в самом пункте не указано иное. Требования и рекомендацию выдвигаются непосредственно к наличию тех или иных блоков.
5. В некоторых примерах в качестве заглушек используется описание подменяемого блока взятое в уголки "<>".

## Случаи документирования

Решение, нужно ли документировать какую-то часть кода или нет, следует принимать, исходя из следующих приоритетов. При этом исключения из разделов "Обязательно", "Рекомендуется" и "По желанию" указаны отдельно в "Не применяется".

### Обязательно

Документирование обязательно должно проводиться для:

1. Классов;
2. Методов;
3. Главных функций в файл-функции (функция, которая первая в файле).

### Рекомендуется

Документирование рекомендуется проводить для:

1. Подфункций (sub-function - функция в одном файле с файл-функцией или классом, но не являющаяся nested-функцией, главной функцией файл-функции или методом класса).
2. Скриптов.

### По желанию

Документирование можно проводить по желанию для:

1. Вложенных функций (nested-function - функция, объявленная внутри другой функции, но не являющаяся анонимной).

### Не применяется

Для тестовых классов представленный здесь подход следует использовать только при документировании методов, не имеющих атрибутов "TestClassSetup", "TestClassTeardown", "Test", "TestMethodSetup", "TestMethodTeardown". Для всех прочих частей тестового класса принципы документирования в разработке.

## Требования и рекомендации

### Общее оформление (Т)

1.Для скриптов документирующий комментарий следует указывать с первой строки файла без отступа.

*Пример:*

```matlab
% Пример документирующего комментария для скрипта
%

a = 12;
disp(a);
```

2.Для функций и классов документирующий комментарий следует начинать на следующей строке после объявления и поддерживать тот же уровень вложенности, что у объявляющего слова документируемой сущности.

*Пример:*

```matlab
classdef ExampleClass < handle 
% ExampleClass - пример класса. 
%
% Объявление класса началось и закончилось на 1-ой строке, 
% поэтому документирующий комментарий начался со второй строки, где знак 
% "%" имеет такой же отступ от начала строки, как и "classdef" - ноль.
%

    methods
        function [veryLongOutputName] = exampleFunc(input1, input2, ...
                                                    veryLongInputName3)
        % exampleFunc - пример функции. 
        %
        % Объявление функции началось на 8-ой строке и 
        % закончилось на 9-ой, поэтому документирующий комментарий начался
        % с 11-ой строки. При этом знак "%" имеет такой же отсутп от начала 
        % строки, как и "function" - 2 tab (8 пробелов).
        %

            ...
        end
    end
end
```

>*Почему так?*
>
> 1. Документирование должно производиться после объявляющего слова, так как тогда MATLAB способен обнаружить соответствующую информацию для вывода в `help` и формирования документации.
> 2. Уровень вложенности документирующего комментария должен поддерживаться таким же, как и у объявляющего слова, так как таким образом, во-первых, умещается больше символов в строке. Во-вторых, согласно пункту 3.4.5. стилистических требований к MATLAB-коду. В-третьих, если на следующей строке после документирующего комментария начинается комментарий к внутреннему коду, то они не сливаются.

3.В конце документирующего комментария следует оставлять один пустой комментарий - строку кода только со знаком "%".

*Пример:*

```matlab
function exampleFunc()
% exampleFunc - следующая строка в этом примере пустая.
%

    ...
end
```

>*Почему так?*
>При выводе `help` пустой комментарий отделит выводимую информацию от поля ввода. Также будет более явное отделение документирующего комментария от основного кода в самом редакторе.

4.Развёрнутое описание функции может как отделяться пустым комментарием от краткого описания, так и следовать сразу за ним на следующей строке.

*Пример:*

```matlab
function exampleFunc1()
% exampleFunc1 - краткий комментарий.
% Развёрнутый комментарий. 
%
    ...
end

function exampleFunc2()
% exampleFunc2 - краткий комментарий.
%
% Развёрнутый комментарий. 
%
    ...
end
```

5.Все блоки документации, следующие после развёрнутого описания, должны отделяться от предыдущего блока одним пустым комментарием.

*Пример:*

```matlab
function exampleFunc()
% exampleFunc - функция-пример.
%
% <Развёрнутое описание>
%
% <Ключевое слово>:
% ...
%
% <Ключевое слово>:
% ...
%

    ...
end
```

### Краткое описание (Т)

1.Краткое описание должно начинаться с имени документируемой функции/класса.

2.После имени через дефис следует краткое описание.

3.Краткое описание должно быть в одну строку.

>*Почему так?*
>В MATLAB документирующий комментарий на первой строке после объявления сущности называется "first-line comment". Он используется для отображения справки по сущности при быстром просмотре файла с ней через проводник и при подсказках.

*Пример:*

```matlab
classdef ExampleClass < handle 
% ExampleClass - класс-пример.
% ...
%

    methods
        function exampleClass()
        % exampleClass - функция-пример.
        % ...
        %

            ...
        end
    end
end
```

### Развёрнутое описание (Р)

1.Развёрнутое описание может быть многострочным.

### Переменные (Т)

1.В случае многострочного документирующего комментария переменной следует поддерживать уровень вложенности.
*Пример:*

```matlab
%   1. value (K, 3) {cell-array} - это начало описание переменной, которое
%   продолжается на следующей строке. 
%   А это продолжение описания переменной на новой строке.
%   2. otherValue (N, M) {double} - а это неправильное оформление
% многострочного документирующего комментария, так как не поддержан уровень
% вложенности.
```

##### Функции

1.В функции документирование переменных производится в общем документируемом комментарии, следующем сразу после объявления функции.

2.При документировании аргументов функции следует использовать ключевые слова.

>*Почему так?*
>Ключевые слова позволяют визуально разделить разнородные аргументы, а также стандартизировать местоположение информации в коде. Дополнительно это позволяет использовать автоматизированные системы составления и контроля документации.

3.Начало описания переменной стоит на 1 уровень вложенности (3 пробела от `%`) глубже от ключевого слова.
*Пример:*

```matlab
function exampleFunc(in1, in2)
% Inputs:
% 1. in1 - переменная, задокументированная с НЕПРАВИЛЬНЫМ отступом.
%   2. in2 - переменная, задокументированная с ПРАВИЛЬНЫМ отсутпом.
```

> *Подсказка:* для правильного отступа достаточно сразу после символа `%` нажать tab, что автоматически сместит каретку вправо на 3 пробела.

>*Замечание:*
>Когда каретка находится в комментарии, нажатие на tab вставит такое количество пробелов, чтобы каретка сместилась на следующий столбец в строке, стоящий после кратного 4.
>Так как отступ до функции всегда составляет $4M, M \in [0; \mathbb{N}]$, то знак `%` документирующего комментария стоит в $4M+1$ столбце. Поэтому нажатие на tab после `%` добавляет 3 пробела, а не 4, смещая каретку в $4M+5$ столбец.

4.Если функция является методом класса, то входной аргумент `this` не документируется.

##### Классы

1.В классах документирование свойств производится непосредственно в блоке `properties`.

2.Каждое свойство документируется при помощи комментария (однострочного или многострочного), начинающегося на той же строке, на которой **закончено** объявление переменной.

>*Почему так?*
>Когда документация располагается таким образом, код оказывается более компактным с точки зрения числа строк. А также документация визуально отделена от объявления переменных.

3.Начало документирующих комментариев (положение "%") для всех свойств должно быть выровнено.

4.Начало документирующего комментария (положение "%") должно отстоять от конца объявления свойства не менее, чем на 1 пробел.

*Пример:*

```matlab
...
    properties
        prop1                       % <Тут располагается документирующий
                                    % комментарий для свойства prop1>
        prop2 = struct("a", 12, ...
                       "b", 24)     % <Тут располагается документирующий
                                    % комментарий для свойства prop2>
    end
...
```

<!-- Предыдущий вариант документирования свойств в классе -->
<!--
2.Каждое свойство документируется при помощи комментария (однострочного или многострочного), расположенного непосредственно над объявлением свойства.
*Пример:*

```matlab
...
    properties
        % <Тут располагается документирующий комментарий для свойства
        % prop1>
        prop1

        % <Тут располагается документирующий комментарий для свойства 
        % prop2>
        prop2
    end
...
```

>*Почему так?*
>Встроенные средства MATLAB распознают документацию для свойств классов в блоке `properties`, когда она располагается указанным выше образом.

3.Рекомендуется отделять одной пустой строкой объявление свойства от следующего после него документирующего комментария для следующего свойства.

4.Следует начинать документирующий комментарий (положение "%") с такого же отступа от начала строки, как и отступ для документируемого свойства.

>*Почему так?*
>Согласно пункту 3.4.5. стилистических требований к MATLAB-коду
-->

#### Ключевое слово (Т)

##### Функции

1.Перечисление переменных производится на следующей строке после соответствующего ключевого слова.

1.Для обязательных входных аргументов следует использовать ключевое слово `Inputs:`.

2.Для опциональных позиционных входных аргументов следует использовать ключевое слово `Positional Inputs:`.

3.Для опциональных именованных входных аргументов следует использовать ключевое слово `Name-Value Inputs:`.

4.Для выходных аргументов следует использовать ключевое слово `Outputs:`.

##### Классы

1.Для классов ключевые слова не используются.

>*Почему так?*
>Документирующие свойства уже явно указаны в сепарированном блоке `properties`, имеющим свои атрибуты.

#### Маркер переменной (Т)

##### Функции

1.Для перечисления обязательных входных переменных следует использовать нумерацию вида `<число>.`
*Пример:*

```matlab
function exampleFunc(in1, in2)
% Inputs:
%   1. in1 - первая переменная
%   2. in2 - вторая переменная
```

> *Почему так?*
> Для обязательных переменных важен порядок ввода. При документировании это подчёркивается их порядковой нумерацией.

2.Если функция является методом класса, то `this` не следует учитывать при нумерации.
*Пример:*

```matlab
...
    methods
        function exampleMethod(this, in1, in2)
        % exampleMethods - метод-пример
        %
        % Inputs:
        %   1. in1 - первая переменная
        %   2. in2 - вторая переменная

            ...
        end
    end
...
```

3.Для перечисления позиционных опциональных переменных следует использовать нумерацию вида `<число>.`, сквозную с обязательными входными переменными.
*Пример:*

```matlab
function examplefunc(in1, in2, optin1, optin2)
% Inputs: 
%   1. in1 - первая обязательная переменная
%   2. in2 - вторая обязательная переменная 
%
% Positional Inputs:
%   3. optin1 - первый опциональный позиционный аргумент.
%   4. optin2 - второй опциональный позиционный аргумент.
%

    arguments 
        in1
        in2
        optin1 = "Default";
        optin2 = "Default";
    end
    ...
end
```

> *Почему так?*
> Позиционные опциональные переменные вводятся после обязательных и так же в строгом порядке. При документировании это подчёркивается их сквозной порядковой нумерацией.

4.Для перечисления опциональных именованных переменных следует использовать маркер вида `*`.
*Пример:*

```matlab
function exampleFunc(options)
% Name-Value Inputs:
%   * namedValue1 - первая именованная переменная.
%   * namedValue2 - вторая именованная переменная.
%

    arguments
        options.namedValue1
        options.namedValue2
    end
    ...
end
```

> *Почему так?*
> Порядок ввода опциональных именованных переменных не принципиален. При документировании это подчёркивается обезличенными маркерами.  

5.Для перечисления выходных переменных следует использовать нумерацию вида `<число>.`
*Пример:*

```matlab
function [out1, out2] = exampleFunc()
% Outputs:
%   1. out1 - первая переменная
%   2. out2 - вторая переменная
```

> *Почему так?*
> Для выходных переменных важен порядок вывода. При документировании это подчёркивается их порядковой нумерацией.

##### Классы

1.При документировании свойств класса следует использовать маркер вида  `*`.
*Пример:*

```matlab
...
    properties
        exampleValue % * exampleValue - одно свойство, у которого очень
                     % длинный комментарий.
        otherValue   % * otherValue - другое свойство.
        
        thirdVal     % * thirdVal - третье свойство.
    end
...   
```

> *Почему так?*
> Маркер `*` позволяет визуально разделить относящиеся к разным свойствам документирующие комментарии. Особенно в случае многострочности оных и при отсутствии пустых строк между объявлениями свойств.

<!-- Предыдущий вариант документирования свойств в классе -->
<!--
1.При документировании свойств класса не используются маркеры.

>*Почему так?*
>Документирующие комментарии для каждого свойства уже визуально отделены, так как идут в порядке: "комментарий"-"свойство"-"комментарий"-"свойство".
-->

#### Имя переменной (Т)

1.Описание любой переменной начинается с указания имени переменной. 

##### Функции

1.Для опциональных именованных переменных указывается имя без `options.`/`params.` и подобных.
*Пример:*

```matlab
function exampleFunc(options)
% Name-Value Inputs:
%   * namedValue1 - первая именованная переменная.
%   * namedValue2 - вторая именованная переменная.
%

    arguments
        options.namedValue1
        options.namedValue2
    end
    ...
end
```

#### Размерность переменной (Т)

1.После имени переменной в круглых скобках через точку с запятой указывается размерность переменной.
*Пример:*

```matlab
%   1. value (12; 78; 90) - переменная с размерностью 12 x 78 x 90
```

> *Почему так?*
> Использование круглых скобок характерно для описания размерностей в валидаторах.
> Точка запятой в качестве разделителя позволяет использовать запятые при текстовом описании размерности.

2.Если какое-либо из измерений возможно описать с точки зрения физического смысла, то следует описывать его именно так.
*Пример:*

```matlab
%   1. satStates (число спутников; число координат пространства + число
%   координат скоростей) - массив состояний КА. В каждой строке содержится
%   набор координат [x, y, z, Vx, Vy, Vz].
```

3.Если какое-либо из измерений может принимать произвольное значение, которое не описывается с точки зрения физического смысла, то следует использовать латинские заглавные буквы $N, M, L, K$ и т.д..
*Пример:*

```matlab
%   1. value (N; 3) - массив из 3 столбцов с произвольным количеством строк,
%   не имеющими явного физического описания.
```

4.Если у нескольких переменных есть измерения, которые не описываются с точки зрения физического смысла, но должны быть одинаковыми, то следует использовать в их описании одинаковую латинскую заглавную букву.
*Пример:*

```matlab
%   1. value1 (N; 3) - переменная с первым измерением произвольного размера.
%   2. value2 (10; K; N) - переменная со второым и третьим измерениями
%   произвольного размера. При этом третье измерение должно равняться по
%   размеру первому измерению value1. 
```

5.Если переменная является скалярной величиной, то указывать для неё размер не обязательно. В случае, если размер указывается, следует писать `(1; 1)`.

6.Если размерность переменной может принимать несколько различных фиксированных значений, то рекомендуется их описать, перечисляя через знак `|`.
*Пример:*

```matlab
%   1. sunDirectionOrb (3; КА; Эпохи) - направление на Солнце в ОСК для
%   каждого КА.
%   2. stateVecEci (КА; 3 + 3; Эпохи) - вектор состояния КА в ECI.
%   3. limAngularRate (Число КА|1; 1) - максимальная угловая скорость
%   поворота КА. [рад/c]
%   Или заданная для каждого КА, или одинаковая для всех КА.
```

#### Тип переменной (Р)

1.После размерности переменной в фигурных скобках следует указывать тип переменной. Под типом переменной понимаются следующие варианты (список не полный):

- `double`, `double-array`
- `logical`
- `string`, `string-array` и `char-array`
- `struct` и `struct-array`
- `cell-array`
- `axes`, `figure`, `line` и подобные им
- различные классы Модели.

*Пример:*

```matlab
sim = Simulation('SystemTargetBaseline');
simArrayT1 = [sim; sim; sim];
simArrayT2 = {sim; sim; sim};

function simArrayProcessing(simArrayT1, simArrayT2)
% Inputs:
%   1. simArrayT1 {Simulation-array} - массив из объектов класса Simulation.
%   2. simArrayT2 {cell-array} - массив ячеек, с объектами Simulation в каждой ячейке.
% 
    ...
end
```

>*Почему так?*
>Без внимательного прочтения кода не всегда очевидно, чем именно является переменная. MATLAB позволяет создавать многомерные массивы из самых разнообразных объектов, поэтому для упрощения их идентификации стоит указывать их тип.

#### Общее описание переменной (Т)

1.Общее описание переменной следует указывать через дефис после основной информации о переменной: маркер, имя, размерность, тип.
*Пример:*

```matlab
%   * perSatValue (Число спутников; 5) {cell-array} - <общее описание
%   переменной>. 
```

2.Общее описание переменной должно давать информацию о физическом смысле переменной, о её содержимом. Возможно включение технической информации о ней, которое не было указано ранее.

3.Допустимо ссылаться на общее описание переменной, которое уже было проведено в ином месте кода в том же файле. В этом случае необходимо придерживаться строгого формата ссылки.

Для ссылки на документацию, приведённую для свойства класса:

```matlab
ref:<Имя класса>.<имя свойства>
```

Для ссылки на документацию, приведённой в ином методе класса:

```matlab
ref:<Имя класса>.<имя метода>.<имя входного/выходного аргумента>
```

Для ссылки на документацию в подфункции:

```matlab
ref:<Имя функции>.<имя входного/выходного аргумента>
```

>*Почему так?*
>Ссылки позволяют избежать ненужного дублирования описаний. Также с помощью строгого формата ссылки возможно автоматизированным образом отслеживать, актуальность документации.

4.При ссылке на общее описание рекомендуется ссылаться на документацию, которая приведена выше по коду, а не ниже.

5.Общее описание переменной может состоять из нескольких предложений.

#### Физическая размерность переменой (Р)

1.Физическую размерность переменной следует указывать в квадратных скобках после общего описания переменной.
*Пример:*

```matlab
%   * distanceToSat - расстояние от наблюдателя до КА. [мм]
```

2.В случае, если переменная содержит значения с различными физическими размерностями, относящихся к разным физическим величинам (т.е., например, в массиве не хранятся одновременно скорость в см/с и в км/ч), допустимо:

- перечислить их через точку с запятой.
- указать их непосредственно в тексте.

*Пример:*

```matlab
%   2. satData (число спутников; 3) {double-array} - данные о КА: расстояние
%   от КА до наблюдателя; скорость КА относительно Солнца; угол между
%   антенной КА и Марсом. [мм; см/с; рад] 
```

*Пример:*

```matlab
%   2. satData (число спутников; 3) {double-array} - данные о КА: расстояние
%   от КА до наблюдателя [мм]; скорость КА относительно Солнца [см/с]; угол
%   между антенной КА и Марсом [рад]. 
```

3.В случае, если переменная содержит значения с различными физическими размерностями, относящимся как к различным, так и к одинаковым физическим величинам, следует указывать физ.размерности непосредственно в тексте.

#### Дополнительное описание переменной (Р)

1.Дополнительное описание переменной следует указывать с новой строки после общего описания переменной/после указания физической размерности.
*Пример:*

```matlab
%   * value - общее описание переменной value без физ.размерности. 
%   Дополнительное описание переменной value.
```

*Пример:*

```matlab
%   * value - общее описание переменной value с физ.размерностью. [м]
%   Дополнительное описание переменной value.
```

2.В дополнительное описание переменной следует включить информацию о переменной, которая не была указана ранее. Это может быть описание, например, того, что в ней значат `NaN`. Или того, какие ограничения на значения имеются.

3.Дополнительное описание переменной может состоять из нескольких предложений.

#### Перечисление допустимых значений (Р)

1.Если значение параметра из ограниченного набора (как правило, ограничение явно указывается при помощи `mustBeMember`) , следует явно указать, как то или иное значение параметра влияет на код.

2.Описание влияния допустимых значений на код следует указывать с новой строки после общего описания переменной, физ.размерности (если есть) и дополнительного описания переменной (если есть).

3.Описание допустимых значений следует начинать с ключевого слова `Allowed:`, после которого с новой строки с увеличенным на 1 уровнем вложенности (`%` +7 пробелов) указываются значения переменных и их влияние на поведение программы.

>*Подсказка:*
>Для получения второго уровня вложенности достаточно сразу после знака `%` дважды нажать tab.

> *Замечание:*
> Как обозначено в замечании выше, в комментариях каретка при нажатии tab смещается на ближайший столбец, кратный 4. Поэтому всё описание переменной производится с 5 столбца (`%` + 3 пробела). Дополнительный уровень вложенности  смещает каретку ещё на 4 столбца вправо.

4.Документирование каждого допустимого значения начинается с маркера `*`, после которого указывается допустимое значение, а затем через дефис - описание влияния на алгоритм.

5.Если какое-то значение из допустимых принято по умолчанию, следует после описания влияния на алгоритм значения указать "(По умолчанию)"

*Пример:*

```matlab
% ...
%   2. units (1, 1) {string} - какую физ.размерность должна иметь
%   возвращаемая температура.
%   Allowed:
%       * "K" - в Кельвинах. (По умолчанию)
%       * "keV" - в кэВах.
%       * "erg" - в эргах.
% 

    arguments
        L
        units {mustBeMember(units, ["K", "keV", "erg"])} = "K";
    end
    ...
```

### Примеры использования (Р)

1.Блок примеров начинается с ключевого слова `Examples:`.

2.Каждый пример отстоит на 1 уровень вложенности (3 пробела от `%`) глубже от ключевого слова.

3.Перечисление примеров начинается со следующей строки от ключевого слова `Examples:`.

4.Каждый пример начинается с маркера `*`, за которым следует текстовое описание последующего примера.

5.Текстовое описание может быть многострочным, но должно поддерживать уровень вложенности относительно ключевого слова.

6.Код примера должен быть обёрнут в начале и в конце тремя апострофами \`\`\`, стоящими вплотную к знаку "%".

>*Почему так?*
>Во-первых, тройной апостроф в начале и в конце соответствует разметке markdown. Во-вторых, такая разметка более надёжно позволит отделить программными средствами код примера от его текстового объяснения.

7.Код примера должен иметь не менее 1-го уровня вложенности (3 пробела от `%`).

>*Почему так?*
>Если писать код сразу от "%" или от "%" + 1 пробел, то нажатие tab сместит каретку на 1-ый уровень вложенности, соответствующий 3-ём пробелам от "%". Поэтому при подобном подходе для правильного выравнивания кода при наличии внутренней вложенности, будет необходимо проставлять дополнительные пробелы или удалять их.

8.Указание файл-скриптов с примерами следует приводить в аналогичном окружении из трёх апострофов, используя следующий синтаксис: `run <имя скрипта-примера>.m` .

>*Почему так?*
>Во-первых, команда `run <имя скрипта-примера>.m` является работоспособной и позволяет запустить скрипт примера.
>Во-вторых, это позволяет единообразно указывать как непосредственно примеры-коды, так и примеры-скрипты, сохраняя возможность лёгкого парсинга.

*Пример:*

```matlab
function exampleFunc(in1, in2)
% ...
% Examples:
%   * Описание первого примера.
%```
%   res = exampleFunc(12, "K");
%   disp(res.val)
%```
%   * Описание второго примера, которое занимает более одной 
%   строки.
%```
%   exampleFunc(1234, 5678);
%```
%   * Описание третьего примера, который расположен в файле
%   exampleForExampleFunc.m
%```
%   run exampleForExampleFunc.m
%```
%
    ...
end
```

### Примечания (Р)

1.Блок примечаний начинается с ключевого слова `Notes:`.

2.Примечания начинаются со следующей строки после ключевого слова `Notes:`.

3.Примечания могут быть многострочными.

### Источники (Р)

**Источники** - ссылки на Confluence, книги и статьи.

1.Блок перечисления источников начинается с ключевого слова `References:`.

2.Начало записи источника стоит на 1 уровень вложенности (3 пробела от `%`) глубже от ключевого слова.

3.Перечисление источников начинается со следующей строки после ключевого слова `References:`.

4.Для перечисления источников следует использовать нумерацию вида `<число>.`.

5.Статью-источник следует указывать в виде doi-ссылки или по ГОСТ Р 7.0.5-2008.

6.Книгу-источник следует указывать в виде ссылки на сайт с возможностью скачивания или по ГОСТ Р 7.0.5-2008.

7.После источника допустимо вставить многострочный комментарий, который отделяется от источника с помощью двойного дефиса и поддерживает уровень вложенности относительно ключевого слова.

*Пример:*

```matlab
%
% References:
%   1. www.example.com -- это пример источника-ссылки с многострочным
%   комментарием после него.
%   2. doi.org/10.3847/1538-4357/acc528 -- это источник-статья в виде 
%   doi-ссылки.
%   3. Засов А. В., Постнов К. А. Общая астрофизика / А. В. Засов,
%   К. А. Постнов, 2-е изд., Фрязино: Век 2, 2011. 576 c.
%
```

### Связанные программы (Р)

**Связанные программы** - потенциально связанные с документируемым кодом алгоритмы. Например, в конце вывода команды `help trapz` перечислены:

```matlab
See also sum, cumsum, cumtrapz, integral.
```

1.Блок перечисления связанных алгоритмов начинается с ключевого слова `See Also:`.

>*Почему так?*
>`See Also` является ключевым словом в MATLAB. При вызове `help` MATLAB автоматически расставит ссылки на `help` связанных алгоритмов для всех указанных после `See Also` имён из области видимости.

2.Перечисление связанных функций/классов производится после `See Also:` со следующей строки через запятую.

3.Перечисление связанных функций/классов допустимо производить на нескольких строках.

4.Допустимо указывать:

- имена скриптов (название файлов без ".m");
- имена файл-функций (в области видимости только заглавная функция, получить `help` для вложенных невозможно);
- имена классов (выводится `help` для класса в целом);
- методы классов, используя синтаксис `<имя класса>.<имя метода>`.

*Пример:*

```matlab
...
% 
% See Also:
% exampleScript, exampleFunction1, ExampleClass, 
% ExampleClass.exampleMethod, ExampleClass.exampleStatic
%
```

### Авторство (Р)

1.При указании авторства на первой строке указывается "Фамилия И.О.".

2.На второй строке указывается последняя дата обновления документации.

*Пример:*

```matlab
% Иванов И.И.
% 01.01.2000
```

### Прочий текст (Р)

#### Классы и функции

1.Формулы в функциях и классах следует оформлять, используя `$<формула>$` для внутристрочных формул и `$$$ <формула на новой строке> $$$` для многострочных формул.

2.Для списков следуюет использовать нумерацию с точкой после числа или маркер-завёздочку.

#### Скрипты

1.В скриптах рекомендуется использовать для оформления [MATLAB Publishing Markup](https://www.mathworks.com/help/matlab/matlab_prog/marking-up-matlab-comments-for-publishing.html).

## Шаблоны

### Переменные

Общий шаблон документирования переменной:

```matlab
<Маркер> <Имя переменной> (<Размерность переменной>) {<Тип переменной>} - <Общее описание переменной>. [<Физическая размерность переменной>]
<Дополнительное описание переменной>.
Allowed: <Перечисление допустимых значений>
```

### Функции и методы

```matlab
function [output] = exampleFunc(input, positionalOptionalInput, options)
% exampleFunc - <Краткое описание>
%
% <Развёрнутое описание>
%
% Inputs:
%   1. input <дальнейшее описание переменной>
%
% Positional Inputs:
%   2. positionalOptionalInput <дальнейшее описание переменной>
%
% Name-Value Inputs:
%   * namedOptionalinput <дальнейшее описание переменной>
%
% Outputs:
%   1. output <дальнейшее описание переменной>
%
% Examples:
%   * <Описание примера с кодом внутри документации>
%```
%   <Код примера>
%```
%   * <Описание примера с кодом внутри скрипт-файла>
%```
%   run <Имя скрипт-примера>.m
%```
%
% Notes:
% <Текст примечания>
%
% References: 
%   1. <источник>
%   2. <источник> -- <комментарий к источнику>
%
% See Also:
% <Программа 1>, <Программа 2>
%
% <Фамилия И.О.>
% <Дата последнего обновления документации>
%
     
    arguments
        input
        positionalOptionalInput = "defaultValue"
        options.namedOptionalInput
    end
 
    ...
end
```

### Классы

```matlab
classdef ExampleClass < handle
% ExampleClass - <Краткое описание>
%
% <Развёрнутое описание>
%
% Examples:
%   * <Описание примера с кодом внутри документации>
%```
%   <Код примера>
%```
%   * <Описание примера с кодом внутри скрипт-файла>
%```
%   run <Имя скрипт-примера>.m
%```
%
% Notes:
% <Текст примечания>
%
% References: 
%   1. <источник>
%   2. <источник> -- <комментарий к источнику>
%
% See Also:
% <Программа 1>, <Программа 2>
%
% <Фамилия И.О.>
% <Дата последнего обновления документации>
%

    properties
        prop1     % * prop1 <дальнейшее описание переменной>
        longProp2 % * longProp2 <дальнейшее описание переменной>
    end

    ...
end
```

## Пример

Ниже приводится два примера документирования игрушечной функции:

- только требуемые разделы;
- все возможные разделы.

Некоторые пояснения в документации могут показаться излишними, однако главная цель здесь - показать, как можно делать и как это будет выглядеть.

В реальном случае необходимость тех или иных рекомендуемых блоков определяют уже сам разработчик и рецензенты. Однако стоит придерживаться правила: ***чем чаще используется функция и чем она важнее для проекта, тем подробнее она должна быть задокументирована.***

### Минимальное заполнение

```matlab
function [temperature] = getTemperature(luminosity, units, options)
% getTemperature - получить температуру из светимости.
%
% Inputs:
%   1. luminosity (N, 1) - светимость.
%
% Positional Inputs:
%   2. units - какую физ.размерность должна иметь возвращаемая температура.
%
% Name-Value Inputs:
%   * verbose - выводить (true) или нет (false) подробности.
%
% Outputs:
%   1. temperature (N, 1) - температура в избранных единицах размерности.
%

    arguments
        luminosity
        units {mustBeMember(units, ["K", "keV", "erg"])} = "K";
        options.verbose {mustBeNumericOrLogical} = true
    end

    temperatureK = (luminosity ./ Const.stefanBoltzmann).^(1./4);

    switch units
        case "K"
            temperature = temperatureK;
        case "keV"
            temperature = temperatureK .* Const.kelvin2kev;
        case "erg"
            temperature = temperatureK .* Const.kelvin2erg;
        otherwise
            error("getTemperature:unexpectedUnits", ...
                  "Получены неожиданные единицы размерности для перевода");
    end

    if options.verbose
        fprintf("Посчитана температура для L = %.5e.\n" + ...
                "Вышло T = %.5f %s\n", luminosity, temperature, units);
    end
    
end
```

### Максимальное заполнение

```matlab
function [temperature] = getTemperature(luminosity, units, options)
% getTemperature - получить температуру из светимости.
% Функция, используя закон Стефана-Больцмана, извлекает температуру из
% светимости. Позволяет сразу пересчитать температуру к нужным единицам, а
% также вывести промежуточный результат в консоль.
%
% Inputs:
%   1. luminosity (N, 1) {double} - светимость. [Вт/м^2]
%   Рекомендуемая точность - 5 и более знаков после запятой.
%
% Positional Inputs:
%   2. units (1, 1) {string} - какую физ.размерность должна иметь
%   возвращаемая температура.
%   Allowed:
%       * "K" - в Кельвинах. (По умолчанию)
%       * "keV" - в кэВах.
%       * "erg" - в эргах.
%
% Name-Value Inputs:
%   * verbose {logical} - выводить (true) или нет (false) подробности.
%   По умолчанию true.
%
% Outputs:
%   1. temperature (N, 1) - температура в избранных единицах 
%   размерности. [units]
%
% Examples:
%   * Вызов с приведением температуры к нужной размерности
%```
%   lum = 10;
%   getTemperature(lum, "erg")
%```
%   * Вызов с отключением вывода в консоль
%```
%   lum = 10;
%   getTemperature(lum, verbose = false);
%```
%   * Пример использования в сложном проекте
%```
%   run getTemperatureExample.m
%```
%
% Notes:
% Данная функция является игрушечным примером. Некоторые пояснения в
% документации могут показаться излишними, однако главная цель здесь -
% показать, как можно делать и как это будет выглядеть. Целесообразность
% тех или иных рекомендуемых блоков определяет уже сам разработчик и 
% рецензенты. Однако стоит придерживаться правила: чем чаще используется
% функция, тем подробнее она должна быть задокументирована.
%
% References:
%   1. https://en.wikipedia.org/wiki/Stefan%E2%80%93Boltzmann_law
%   2. https://doi.org/10.1002/andp.18842580616 -- исходная статья от 
%   Людвига Больцмана.
%
% See Also:
% getLuminosity, calcEddingtonLuminosty
%
% Нежин А.Н.
% 10.05.25
%

    arguments
        luminosity
        units {mustBeMember(units, ["K", "keV", "erg"])} = "K";
        options.verbose {mustBeNumericOrLogical} = true
    end

    temperatureK = (luminosity ./ Const.stefanBoltzmann).^(1./4);

    switch units
        case "K"
            temperature = temperatureK;
        case "keV"
            temperature = temperatureK .* Const.kelvin2kev;
        case "erg"
            temperature = temperatureK .* Const.kelvin2erg;
        otherwise
            error("getTemperature:unexpectedUnits", ...
                  "Получены неожиданные единицы размерности для перевода");
    end

    if options.verbose
        fprintf("Посчитана температура для L = %.5e.\n" + ...
                "Вышло T = %.5f %s\n", luminosity, temperature, units);
    end

end
```

## TODO

1. Доработать логику документирования `varargin` и `varargout` для случаев, когда поведение функции различно для различного числа входных/выходных переменных.
2. Доработать требования для оформления скриптов-примеров -- зависит от появления в Бюро версии MATLAB R2024b.
3. Доработать принципы документирования для тестовых классов.
4. Доработать принцип формирования Contents.m.
